# $Id$
# Creates the header file containing HAVE_* #defines indicating the presence of
# functions in system headers, library headers and library binaries.

from makeutils import extractMakeVariables

import sys

def iterProbeHeader(probeMakePath):
	probeVars = extractMakeVariables(probeMakePath)

	yield '// Automatically generated by build system.'
	for name, value in sorted(probeVars.iteritems()):
		if name.startswith('HAVE_'):
			if value:
				yield '#define %s 1' % name
			else:
				yield '// #undef %s' % name

if __name__ == '__main__':
	if len(sys.argv) == 2:
		for line in iterProbeHeader(sys.argv[1]):
			print line
	else:
		print >> sys.stderr, (
			'Usage: python probe_header.py PROBE_MAKE'
			)
		sys.exit(2)
