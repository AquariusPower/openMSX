<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
"http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<link title="Purple" rel="stylesheet" href="manual-purple.css" type="text/css" />
<link title="Minty" rel="alternate stylesheet" href="manual-minty.css" type="text/css" />
<link title="Plain" rel="alternate stylesheet" href="manual.css" type="text/css" />
<title>openMSX User's Manual</title>
</head>

<body>

<h1>openMSX User's Manual</h1>

<p class="todo">
Document is under construction.
Please check back here later.
In the mean time,
read <code>openMSX-HOWTO.txt</code> inside the openMSX tree.
</p>

<h2>Contents</h2>

<ol class="toc">
	<li><a class="internal" href="#intro">1. Introduction</a>
		<ol class="toc">
			<li><a class="internal" href="#newver">1.1. New Versions of this Document</a></li>
			<li><a class="internal" href="#purpose">1.2. Purpose</a></li>
			<li><a class="internal" href="#contrib">1.3. Contributors</a></li>
			<li><a class="internal" href="#history">1.4. Revision History</a></li>
		</ol>
	</li>
	<li><a class="internal" href="#runsoftsimple">2. Running MSX Software (simple)</a>
		<ol class="toc">
			<li><a class="internal" href="#xxxxxxxxxxx">2.x. xxxxxxxxxxxt</a></li>
		</ol>
	</li>
	<li><a class="internal" href="#compile">3. Compilation</a>
		<ol class="toc">
			<li><a class="internal" href="#xxxxxxxxxxx">2.x. xxxxxxxxxxxt</a></li>
		</ol>
	</li>
	<li><a class="internal" href="#contact">6. Contact Info</a></li>
</ol>


<p class="todo">
Similar to Compile Guide.
</p>

<h2><a id="intro">1. Introduction</a></h2>

<h3><a id="newver">1.1. New Versions of this Document</a></h3>
<p>
The latest version of the openMSX manual can be found on the openMSX home page:
</p>
<p>
<a class="external" href="http://openmsx.sf.net/manual/">http://openmsx.sf.net/manual/</a>
</p>
<p>
You can also use this URL to get up-to-date versions of the hyperlinks
if you printed out this manual.
</p>

<h3><a id="purpose">1.2. Purpose</a></h3>
<p>
This guide is about openMSX, the open source MSX emulator that tries to achieve
near-perfect emulation by using a novel emulation model.
You can find more information about openMSX on the
<a class="external" href="http://openmsx.sf.net/">openMSX home page</a>.
You can also download the emulator itself from there.
</p>

<p>
openMSX is in alpha state, which means that some things work but not all
features are implemented yet.
Many emulation features are implemented, but in terms of user interface
it is rather bare bones.
However, since the emulation is already pretty good,
it would be nice if non-insiders would be able to play with it, too.
For those people, we have written this guide.
It explains how you can make use of the features of the emulator, once you have got it running.
</p>

<p>
<em>Disclaimer:</em>
We do not claim this guide is complete or even correct.
What you do with the information in it is entirely at your own risk.
We just hope it helps you enjoy openMSX more.
</p>

<h3><a id="contrib">1.3. Contributors</a></h3>

<p>
The following people contributed to this document in one way or another:
</p>
<ul>
<li>Jorrith Schaap</li>
<li>Manuel Bilderbeek</li>
<li>Maarten ter Huurne</li>
<li>other openMSX developers</li>
</ul>
<p>
Thanks to all of them!
</p>

<h3><a id="history">1.4. Revision History</a></h3>

<p>
This section gives an overview of the changes that were made to this document.
It doesn't contain every single modification (use the CVS log for that),
only the big picture.
</p>

<dl>

<dt>2003-08-02: Maarten ter Huurne and Manuel Bilderbeek</dt>
<dd>
Split the User's Manual off from the openMSX HOWTO.
Converted to XHTML.
Restructured the document.
Rewrote some text to fit better in the new structure and format.
</dd>

<dt>2002, 2003: Manuel Bilderbeek &amp; others</dt>
<dd>
Various updates to the HOWTO.
</dd>

<dt>2002: Manuel Bilderbeek &amp; Jorrith Schaap</dt>
<dd>
Original text written as part of the openMSX HOWTO.
</dd>

</dl>

<h2><a id="console">x Controlling the Emulator</a></h2>

<h3><a id="console">x.x Console</a></h3>

<p>
When the emulator is running, you can get the "Console" by pressing F10 (with default key mapping) when
the focus is on the emulator window. This will give you a command line in the
openMSX window. Typing <code>help</code> gives a list of commands. They are described in
the file <code>doc/commands.txt</code> in the source tree. The console is mostly used to
change disk images, plug in joysticks or mice, make settings and to define
key bindings. You can specify a background image and the font in the config
file (<code>&lt;config id="Console"&gt;</code>). The png files need an alpha channel (transparency
information) though.
</p>

<p>
Again, the full list of <a class="internal" href="#console">Console</a> commands can be found in <code>doc/commands.txt</code> and
when typing <code>help</code> in the <a class="internal" href="#console">Console</a> itself. You can also type <code>help &lt;command&gt;</code> to
get some help about a specific <a class="internal" href="#console">Console</a> command.
</p>

<p class="todo">
Add the complete list of commands.txt somewhere.
</p>

<h3><a id="other">x.x Some Important Console Commands</a></h3>

<p>
You can reset your MSX with the <a class="internal" href="#console">Console</a> command <code>reset</code>.
</p>

<h3><a id="settings">x.x Settings</a></h3>

<p>
An interesting console command is <code>set</code>. You can use it to change the various
settings. E.g., you can use it to set the renderer that is to be used. And the
<code>blur</code>, <code>glow</code> and <code>scanline</code> setting of the GL renderer can be tweaked with it. For details what I'm talking about, see at TODO_REFERENCE.
Settings that have only two possible values can also be toggled with the <code>toggle</code>
command (an example is the default key binding of Print Screen to <code>toggle
fullscreen</code>, see also below). A complete list of settings should also be in the file
<code>commands.txt</code> in the doc directory.
</p>
<p class="todo">
Add the complete list of commands.txt somewhere.<br/>
Fix reference.
</p>


<h4><a id="importantsettings">x.x.x Some Simple But Important Settings</a></h4>

<p>
If the MSX goes too fast or too slow, adjust the emulation speed with the
<code>speed</code> setting, which has the speed percentage as parameter. So, typing <code>set
speed 120</code>, will let the emulated MSX run at 120% of normal MSX speed.
</p>

<p>
If you want openMSX to emulate the blinking interlace effect as can be seen on a
real MSX, try <code>set deinterlace off</code>... I recommend to turn it on though, the
blinking is quite irregular on most systems and thus a pain for the eyes
(unless you combine it with the <code>glow</code> effect in SDLGL).
</p>



<h4><a id="renderers">x.x.x Renderers</a></h4>

<p>
At the moment, there are three working renderers. A renderer is a part of the
emulator that generates the graphical part of the emulation: the MSX 'screen'.
</p>

<p>
The default renderer is called SDLHi. This one uses a window of 640&times;480
pixels to be able to display all the screen lines, even when interlacing is used
on the MSX. This renderer is not using any hardware acceleration and has a
steady CPU time consumption. The CPU load can be quite high though. It is about
50% on Manuel's Athlon XP 1600+, when emulating a 3.5MHz MSX.
</p>

<p>
A very good alternative for the Hi renderer is called SDLGL. This renderer uses
openGL instructions to optimise the rendering. Because part of the rendering is
done by the graphics hardware, the CPU load can vary a lot. Also, you need to
have the GLX module loaded in your X server and also accelerated graphics (DRI).
You can verify this by typing <code>glxinfo</code> on the command line. Direct rendering
should be enabled to benefit from this renderer. GL also makes some effects
easier: when using the SDLGL renderer, there is a <code>blur</code>, <code>glow</code> (afterglow!) and
<code>scanline</code> setting (see <a class="internal" href="#console">Console</a>), to imitate a TV screen. This does not work
properly with all graphics cards, though. It should work with nVidia cards, at
least. Note that the GL renderer is only available when the openGL development
files (<code>gl.h</code> is one of them) were installed on the computer at compile time.
This will be checked by the <code>configure</code> script.
</p>

<p>
The third working renderer is called SDLLo. This renderer uses a window of only
320&times;240 pixels, which means that part of the MSX screen will be omitted. An
'interpolation' (blending) algorithm to reduce this problem was added for 16
and 24bpp visuals. I don't recommend to use this renderer, unless you have an
extremely slow computer.
</p>

<p>
You can set the renderer in the <code>settings.xml</code> file. Look for <code>&lt;config
id="renderer"&gt;</code>.  You can also specify there whether the emulator should switch
to full screen when started. You can also switch renderer from the <a class="internal" href="#console">console</a>.
</p>

<h4><a id="accuracy">x.x.x Renderer Accuracy</a></h4>

<p>
Another example of the settings that you can specify in the <a class="internal" href="#console">Console</a> is the
accuracy of the rendering. There are three options: <code>screen</code>, <code>line</code> and
<code>pixel</code>'. The latter is the slowest, but most accurate setting (it also shows
that the timing in openMSX is not perfect yet): it will enable you to run the
Unknown Reality real time oscilloscope almost flawlessly!  Just type <code>set
accuracy pixel</code> in the console. You can use the default <code>line</code> accuracy for
almost every other piece of software. <code>screen</code> is the fastest, but least
accurate setting. This will break a lot of software that uses raster effects.
</p>


<h2><a id="media">x. Media</a></h2>

<p>
With this information, you can run most of the existing MSX software.
</p>

<!--
<p>
A completer command line options help can be seen by typing:
</p>
<div class="commandline">openmsx -help</div>
-->

<h3><a id="roms">x.x Running ROM software</a></h3>

<p>
Suppose you want to run the ROM file <code>galious.rom</code>. Then you simply type:
</p>
<div class="commandline">openmsx galious.rom</div>
<p>
and the emulated MSX will run the game. (Of course,
in this case, the file <code>galious.rom</code> should be in the current directory or in one
of the UserDirectories you specified in the <code>settings.xml</code>, see below.)
</p>
<p class="todo">
Fix the above reference.
</p>

<p>
If things go terribly wrong, openMSX may not have the .rom extension registered
as a ROM image (it does have that by default, though, but this is just an
example). You can then indicate this by typing:
</p>
<div class="commandline">openmsx -cart galious.rom</div>
<p>
Or, maybe openMSX didn't have the ROM in the ROM database and failed autodetection of the mapper type. You can specify the mapper to KONAMI4 like this:
</p>
<div class="commandline">openmsx galious.rom,KONAMI4</div>
<p>
Note that in practice you won't need this, since most ROM images are in the database or autodetected if they are not.
</p>

<h3><a id="disks">x.x Running Disk Software</a></h3>

<h4><a id="diskimages">x.x.x Using Disk Images</a></h4>

<p>
To run a disk image, you can type:
</p>
<div class="commandline">openmsx relax.dsk</div>
<p>
for example. Or, if you haven't registered the .dsk extension for disk images:
</p>
<div class="commandline">openmsx -diska relax.dsk</div>

<p>
You can also change disks at run time of course. Just type
</p>
<div class="commandline">
    diska &lt;diskimage&gt;
</div>
<p>
in the <a class="internal" href="#console">Console</a> to put the specified disk image in drive A.
</p>

<h4><a id="realdisks">x.x.x Using Real Disks (Linux)</a></h4>

<p>
To use a real disk, just specify <code>/dev/fd0</code> as a disk image. This is of
course a Linux (Unix, actually) specific feature, but for now it is usable. It
may be a bit slow though, with the FDC emulation enabled. It should be just as
slow as a real disk drive, however!
</p>

<h3><a id="tape">x.x Running Tape Software</a></h3>

<p>
openMSX supports WAV files for tape emulation! Just configure your MSX with a
cassette port (or use a premade MSX that already has it):
</p>
<div class="commandline">
     &lt;config id="CassettePort"&gt;
</div>
<div class="commandline">
     &lt;/config&gt;
</div>
<p>
Then type in the console:
</p>
<div class="commandline">
     plug cassetteport cassetteplayer
</div>
<div class="commandline">
     cassetteplayer &lt;file&gt;.wav
</div>
<p>
And then in MSX Basic, type:
</p>
<div class="commandline">
     run"cas:"
</div>
<p>
(or another command to load the program on 'tape'.)
</p>

<p>
You can also use the so-called CAS files. In the <a class="internal" href="#console">Console</a>, type:
</p>
<div class="commandline">
     cas &lt;tapeimage&gt;.cas
</div>
<p>
and
</p>
<div class="commandline">
     cas eject
</div>
<p>
to remove the tape from the virtual cassette player. This only works with a
patched BIOS ROM, though. You can find an example of the patch in
<code>exampleconfigs.xml</code>.
</p>

<p>
Because patching a BIOS is not really something you want, a new feature was recently added to openMSX. You can use CAS files with cassetteplayer as if they were WAV files now! They are automatically converted to WAV files, internally. Note that the loading time is drastically longer this way.
</p>

<p>
Other cassetteplayer related commands/setting you need to know of are:
</p>
<ul>
	<li><code>cassetteplayer rewind</code>, to rewind the tape</li>
	<li><code>cassetteplayer eject</code>, to eject the tape</li>
	<li><code>set cassetteplayer_volume</code>, to set the volume of the cassette player sound (yeah, the screeching tape sounds!)</li>
</ul>


<h2><a id="input">x. Input Devices</a></h2>

<h3><a id="keymapping">x.x Default Key Mapping</a></h3>

<p>
The default key mapping is as follows:
</p>

<table>
  <tr> <td>F12</td> <td>Quit openMSX</td> </tr>
  <tr> <td>F11</td> <td>Mute audio</td> </tr>
  <tr> <td>F10</td> <td>Console (see section TODO)</td> </tr>
  <tr> <td>F9</td> <td>Full Throttle (maximum speed)</td> </tr>
  <tr> <td>F8</td> <td>MSX STOP key</td> </tr>
  <tr> <td>F7</td> <td>MSX SELECT key</td> </tr>
  <tr> <td>L-ALT</td> <td>MSX GRAPH key</td> </tr>
  <tr> <td>R-CTRL</td> <td>MSX CODE key</td> </tr>
  <tr> <td>L-Windows</td> <td>MSX iee (`no') key</td> </tr>
  <tr> <td>R-Windows</td> <td>MSX hai (`yes') key</td> </tr>
  <tr> <td>Pause</td> <td>Pause emulation</td> </tr>
  <tr> <td>PrtScr</td> <td>Toggle Full Screen</td> </tr>
</table>
<p class="todo">
Make the table look better by using cellpadding stuff in the css.
</p>
<p>
The keys that do not map MSX keys, can be changed in the <code>settings.xml</code> file.
</p>

<h3><a id="joystick">x.x Joystick</a></h3>

<p>
To connect a fake joystick (emulated with the arrow keys), you can use the <code>plug</code> command:
</p>
<div class="commandline">
    plug joyporta keyjoystick
</div>
<p>
will connect a fake joystick to joystick port A.
</p>

<h3><a id="mouse">x.x Mouse</a></h3>

<p>
To connect a mouse, you can also use the <code>plug</code> command:
</p>
<div class="commandline">
    plug joyporta mouse
</div>
<p>
will connect a mouse to joystick port A. If you want the joystick emulation feature that some mice (like the Philips SBC-3810 and the Sony MOS-1) have, keep the left mouse key pressed when plugging it in, just as on a real MSX.
</p>


<h2><a id="machines-extensions">x. Using Machines and Extensions</a></h2>

<p>
To use a specific MSX machine that is present on your system (i.e. your openMSX installation), simply use the <code>-machine</code> command line argument, like this:
</p>
<div class="commandline">
    openmsx -machine Panasonic_FS-A1GT
</div>


<p> 
Extensions are simply MSX cartridges (extensions to the MSX system) that you can plug into the emulated MSX. In the next paragraph we explain this using an example.
</p>

<p>
If you have setup an FM PAC <code>hardwareconfig.xml</code> file in
<code>~/.openMSX/share/extensions/fmpac</code> e.g., you can add  <code>-ext
fmpac</code> to your command line to use an FM PAC. But, as I just said, you
need to have a hardware description in that subdirectory of
<code>share/extensions/</code>, see chapter TODO (SETUP GUIDE). Fortunately,
openMSX comes with a predefined FM-PAC extension. You only need to add the
<code>fmpac.rom</code> in <code>share/extensions/fmpac/roms/</code>; it's the ROM that is built in the FM-PAC. If you look at that <code>share/extensions</code>
directory, you will find more extensions. E.g. using <code>-ext mbstereo</code>
gives you the Moonblaster stereo effect: FM PAC on one channel and MSX Audio on
the other. Try them out, if you like, but again, keep in mind that some
extensions need a ROM image installed in their <code>roms/</code> directory.
</p>
<p class="todo">
Add reference to setup guide above. Or, actually move part of it to that guide.
</p>

<h2><a id="configfile">x. Configuration File </a></h2>

<p class="todo">
Make subsections for all parts of the configuration (settings.xml) file. Or should this be in the setup guide? Probably!
</p>

<h3><a id="autocommands">x.x AutoCommands and KeyEventInserter</a></h3>

<p>
In the config file section <code>AutoCommands</code>, you can specify some console commands
that should be executed automatically. See the <code>settings.xml</code> or
<code>exampleconfigs.xml</code> file for some examples. The <code>settings.xml</code> file uses this to
create the default key bindings.
You can also use it to make default settings that are done with <a class="internal" href="#console">Console</a>
commands. In my case I set <code>blur</code> and <code>scanline</code> to 0, since they don't work
correctly with my Radeon drivers.  The <code>KeyEventInserter</code> section can be used to
have something typed into the MSX after it booted. Again, see the
<code>exampleconfigs.xml</code> file. Examine this file to learn what you can configure more.
</p>

<h2><a id="contact">6. Contact Info</a></h2>

<p>
Since openMSX is still in heavy development, feedback and bug reports are very
welcome!
</p>

<p>
If you encounter problems, you have several options:
</p>

<ol>
<li>
If you're a regular user and want to discuss openMSX and possible problems,
join our <code>openmsx-user</code> mailing list.
More info on the
<a class="external" href="http://sourceforge.net/mail/?group_id=38274">openMSX mailing lists</a>,
including an archive of old messages, can be found at SourceForge.
</li>
<li>
Go to our IRC channel: <code>#openMSX</code> on <code>irc.freenode.net</code>
and ask your question there.
</li>
<li>
If you want to address the openMSX developers directly,
post a message to the <code>openmsx-devel</code> mailing list.
More info on the
<a class="external" href="http://sourceforge.net/mail/?group_id=38274">openMSX mailing lists</a>,
including an archive of old messages, can be found at SourceForge.
</li>
<li>
Use one of the
<a class="external" href="http://sourceforge.net/tracker/?group_id=38274">openMSX trackers</a>
at SourceForge.
At the moment of writing, there are four trackers:
Bugs, Support Requests, Patches and Feature Requests.
</li>
</ol>

<!--
<p>
For experienced users: if you get a crash,
try to provide a <code>gdb</code> backtrace.
This will only work if you did not strip the openMSX binary
of its debug symbols.
</p>
-->

<p>
In any case, try to give as much information as possible when you describe your
bug or request.
</p>

<pre>
10.4 Performance

Note: maybe some of these belong in the Setup Guide instead.

CPU and graphics performance varies a lot, depending on the openMSX settings
and the MSX hardware and software you're emulating.
Some things run fine on a 200MHz machine, others are slow on a 2GHz machine.
Some performance tips:
* Make sure there are no CPU consuming background processes running.
* Generally, MSX1 emulation is fastest and turbo R emulation is slowest.
* SDLGL renderer needs hardware acceleration to run at a decent speed.
  Disabling scanlines and blur (set to 0) helps on older graphics cards.
  Our experience is that performance is better if you use SDLGL in stead of
  SDLHi, on systems with a very fast and complete openGL implementation (like
  nVidia card/drivers, e.g.)
* Use 16-bit colour mode instead of 32-bit (platform setting is used).
* Use line accuracy (default) instead of pixel accuracy.
* Turn on frame skip ("set frameskip auto") in the console.
* Use low-res SDLLo renderer (75% less pixels to fill).
</pre>

<p class="version">
$Id$
</p>

</body>
</html>
