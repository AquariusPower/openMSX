<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
"http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<link title="Purple" rel="stylesheet" href="manual-purple.css" type="text/css" />
<link title="Minty" rel="alternate stylesheet" href="manual-minty.css" type="text/css" />
<link title="Plain" rel="alternate stylesheet" href="manual.css" type="text/css" />
<title>openMSX Compilation Guide</title>
</head>

<body>

<h1>openMSX Compilation Guide</h1>

<h2>Contents</h2>
<ol class="toc">
	<li><a class="internal" href="#intro">1. Introduction</a>
		<ol class="toc">
			<li><a class="internal" href="#newver">1.1. New Versions of this Document</a></li>
			<li><a class="internal" href="#purpose">1.2. Purpose</a></li>
			<li><a class="internal" href="#contrib">1.3. Contributors</a></li>
			<li><a class="internal" href="#history">1.4. Revision History</a></li>
		</ol>
	</li>
	<li><a class="internal" href="#getsource">2. Getting the Source Code</a>
		<ol class="toc">
			<li><a class="internal" href="#getrelease">2.1. Released Version</a></li>
			<li><a class="internal" href="#getcvs">2.2. CVS Checkout</a></li>
			<li><a class="internal" href="#getsnapshot">2.3. CVS Snapshot</a></li>
		</ol>
	</li>
	<li><a class="internal" href="#compile">3. Compilation</a>
		<ol class="toc">
			<li><a class="internal" href="#tools">3.1. Build Tools</a></li>
			<li><a class="internal" href="#libs">3.2. Libraries</a></li>
			<li><a class="internal" href="#compilenow">3.3. Compilation Itself</a></li>
		</ol>
	</li>
	<li><a class="internal" href="#install">4. Installation</a></li>
	<li><a class="internal" href="#next">5. Next Steps</a></li>
	<li><a class="internal" href="#contact">6. Contact Info</a></li>
</ol>

<h2><a id="intro">1. Introduction</a></h2>

<h3><a id="newver">1.1. New Versions of this Document</a></h3>
<p>
The latest version of the openMSX manual can be found on the openMSX home page:
</p>
<p>
<a class="external" href="http://openmsx.sf.net/manual/">http://openmsx.sf.net/manual/</a>
</p>
<p>
You can also use this URL to get up-to-date versions of the hyperlinks
if you printed out this manual.
</p>

<h3><a id="purpose">1.2. Purpose</a></h3>
<p>
This guide is about openMSX, the open source MSX emulator that tries to achieve
near-perfect emulation by using a novel emulation model.
You can find more information about openMSX on the
<a class="external" href="http://openmsx.sf.net/">openMSX home page</a>.
You can also download the emulator itself from there.
</p>

<p>
openMSX is in alpha state, which means that some things work but not all
features are implemented yet.
Many emulation features are implemented, but in terms of user interface
it is rather bare bones.
However, since the emulation is already pretty good,
it would be nice if non-insiders would be able to play with it, too.
For those people, we have written this guide.
It explains how you can get the emulator running on your system,
i.e. how to get the sources and compile them.
</p>

<p>
This guide describes how you can get the openMSX sources and compile them
on a Linux machine.
Linux is the OS used by most openMSX developers.
Running on BSD, Mac OS X, BeOS etc (wherever SDL runs) should be possible,
but will probably not work out-of-the-box.
If you are compiling on such a platform,
please share your experiences
(see below for <a class="internal" href="#contact">contact info</a>),
so we can make openMSX more portable.
Windows users should have a look at
<a class="external" href="http://www.ranpub.com/openMSX4Win32/"
>Reikan's Win32 port</a>.
Reikan has Windows binaries available as well, so you only have to build from
source if you're interested in making changes.
</p>

<p>
<em>Disclaimer:</em>
We do not claim this guide is complete or even correct.
What you do with the information in it is entirely at your own risk.
We just hope it helps you enjoy openMSX more.
</p>

<h3><a id="contrib">1.3. Contributors</a></h3>

<p>
The following people contributed to this document in one way or another:
</p>
<ul>
<li>Jorrith Schaap</li>
<li>Manuel Bilderbeek</li>
<li>Maarten ter Huurne</li>
<li>other openMSX developers</li>
</ul>
<p>
Thanks to all of them!
</p>

<h3><a id="history">1.4. Revision History</a></h3>

<p>
This section gives an overview of the changes that were made to this document.
It doesn't contain every single modification (use the CVS log for that),
only the big picture.
</p>

<dl>

<dt>2003-07-06: Maarten ter Huurne</dt>
<dd>
Split the Compilation Guide off from the openMSX HOWTO.
Converted to XHTML.
Restructured the document.
Rewrote some text to fit better in the new structure and format.
</dd>

<dt>2002, 2003: Manuel Bilderbeek &amp; others</dt>
<dd>
Various updates to the HOWTO.
</dd>

<dt>2002: Manuel Bilderbeek &amp; Jorrith Schaap</dt>
<dd>
Original text written as part of the openMSX HOWTO.
</dd>

</dl>

<h2><a id="getsource">2. Getting the Source Code</a></h2>

<p>
openMSX is developed using the tools
<a class="external" href="http://www.sourceforge.net/">SourceForge.net</a>
freely offers to open source projects.
The code is stored in CVS, an open source version management system.
Once in a while an openMSX release is made.
</p>

<p>
There are several options for getting the source code:
</p>

<dl>

<dt><a class="internal" href="#getrelease">Released Version</a></dt>
<dd>
These are tested versions, which should give you little problem compiling
and running.
However, as openMSX development if often quite fast, they may not have all
the latest features.
Also there could be bugs that have been fixed since the last release.
</dd>

<dt><a class="internal" href="#getcvs">CVS Checkout</a></dt>
<dd>
Through anonymous CVS you can get the same development version the
openMSX developers are using.
This is the bleeding edge:
the latest stuff, which may be great or may be horribly broken.
Usually openMSX CVS compiles and runs fine, but we're only human,
so once in a while it breaks.
Also there may be changes that are not documented yet.
</dd>

<dt><a class="internal" href="#getsnapshot">CVS Snapshot</a></dt>
<dd>
A snapshot is created from a recent CVS checkout,
in a <code>tar.gz</code> archive.
A snapshot is therefore quite similar to a CVS checkout,
but it doesn't require you to install and use CVS.
</dd>

</dl>

<p>
Releases are intended for general users, CVS and CVS snapshots are intended for
(would be) developers, heavy testers and people who want to follow new
developments closely. It might be a good idea to play with a release first. If
you like what you see and want to get in deeper, you can switch to CVS later.
If you update often, it is best to use a CVS checkout rather than
a CVS snapshot, because with a checkout you can do efficient incremental
updates, saving network bandwidth and compile time.
</p>

<p>
If you downloaded a version that is either a lot older or a lot newer than
this guide, it is a good idea to read the guide included in your downloaded
version instead of the version you're reading right now.
You can find the Compilation Guide in the directory
<code>openMSX/doc/manual</code>.
</p>

<h3><a id="getrelease">2.1. Released Version</a></h3>

<p>
You can download a released version of openMSX from
<a class="external" href="http://sourceforge.net/project/showfiles.php?group_id=38274"
>the download page at SourceForge</a>.
The latest version is probably the best one.
</p>

<p>
After downloading, type:
</p>
<div class="commandline">tar xzvf openmsx-VERSION.tar.gz</div>
<p>
in which <code>VERSION</code> is the openMSX version you downloaded,
or use the file name you saved the tar.gz file with.
The directory that is created by uncompressing the <code>tar.gz</code> file
is called the <em>top of the source tree</em>.
</p>

<h3><a id="getcvs">2.2. CVS Checkout</a></h3>

<p>
Getting a CVS checkout means you use CVS to retrieve the latest version
of the source code of openMSX.
This means you will need to install a CVS client.
This package is usually simply named <code>cvs</code>.
There are graphical front-ends for CVS,
but this guide will tell you how to use CVS from the command line.
More information about CVS can be found on the
<a class="external" href="http://www.cvshome.org/">CVS Home</a> site.
</p>

<p>
With the following line you can login to the openMSX CVS server:
</p>
<div class="commandline">
cvs -d:pserver:anonymous@cvs.openmsx.sourceforge.net:/cvsroot/openmsx login
</div>
<p>
In this line you specified where you want to retrieve the files from
(host name of the CVS server),
as who you want to retrieve the stuff
(since you're not a developer, <code>anonymous</code> will do),
and what project you want to retrieve (openmsx in this case).
</p>

<p>
You will be prompted for a password.
The password for user <code>anonymous</code> is empty, so just press enter.
</p>

<p>
Example output:
</p>
<div class="commandline">
jorrith@jardel openmsx $ cvs -d:pserver:anonymous@cvs.openmsx.sourceforge.net:/cvsroot/openmsx login
</div>
<div class="commandline">
Logging in to :pserver:anonymous@cvs.openmsx.sourceforge.net:2401/cvsroot/openmsx
</div>
<div class="commandline">
CVS password:
</div>
<div class="commandline">
jorrith@jardel openmsx $
</div>

<p>
Now you can retrieve the latest sources with the following command:
</p>
<div class="commandline">
cvs -z3 -d:pserver:anonymous@cvs.openmsx.sourceforge.net:/cvsroot/openmsx checkout openMSX
</div>
<p>
This will create a directory called <code>openMSX</code> for you
in the current directory.
This directory created by CVS is the called <em>top of the source tree</em>.
In addition to the openMSX code, you will see CVS administration directories
which are all called <code>CVS</code>.
Do not mess with these, otherwise CVS will get confused.
</p>
<p>
If you want to update your source tree later,
go to the top of the source tree and type:
</p>
<div class="commandline">
cvs update -d
</div>
<p>
The <code>-d</code> option tells CVS to check out new directories that were
created since your last checkout/update.
</p>

<h3><a id="getsnapshot">2.3. CVS Snapshot</a></h3>

<p>
First, download the
<a class="external"
href="http://openmsx.sourceforge.net/openMSX-CVS-snapshot.tar.gz"
>most recent CVS snapshot</a>.
</p>

<p>
After downloading, type:
</p>
<div class="commandline">tar xzvf openMSX-CVS-snapshot.tar.gz</div>
<p>
The directory that is created by uncompressing the <code>tar.gz</code> file
is called the <em>top of the source tree</em>.
</p>

<h2><a id="compile">3. Compilation</a></h2>

<p>
Before you can start compiling openMSX, you have to make sure your system
has all the necessary build tools installed, as well as the libraries
openMSX depends upon.
The following sections list the packages you need.
</p>

<h3><a id="tools">3.1. Build Tools</a></h3>

<p>
For compilation, you need Make and a C++ compiler.
If you have compiled packages from source before,
you probably have these installed already.
</p>

<dl>

<dt>make</dt>
<dd>GNU implementation of the Make tool.
Make interprets rules that define how a project should be built.</dd>

<dt>g++</dt>
<dd>The GNU C++ compiler.
Version 3.2 or 3.3 is recommended;
2.95 should work, but may not be supported in the near future.</dd>

</dl>

<p>
If you want to install source from CVS, you need the GNU Automake utilities.
This includes the following packages:
</p>

<dl>

<dt>automake</dt>
<dd>A tool for generating (GNU Standard compliant) Makefiles.</dd>

<dt>autoconf</dt>
<dd>Automatic configure script builder.</dd>

<dt>libtool</dt>
<dd>Generic library support script.</dd>

<dt>m4</dt>
<dd>A macro processing language.</dd>

</dl>

<h3><a id="libs">3.2. Libraries</a></h3>

<p>
openMSX depends on several libraries.
You must have the runtime packages of these libraries install to be
able to run openMSX.
The runtime package for the "Foo" library is typically called
<code>libfoo</code>.
Also, for compiling openMSX you need the development packages of these
libraries installed as well.
Development packages are typically named
<code>libfoo-dev</code> or <code>libfoo-devel</code>.
</p>

<p>
First of all, you need some SDL packages,
the run time ones and also the developer packages.
You need the general SDL libs and SDL_image.
The exact names of the package are different for each distribution.
On a Debian testing system, they are called:
</p>

<dl>

<dt>libsdl1.2debian and libsdl1.2-dev</dt>
<dd>Simple DirectMedia Layer.</dd>

<dt>libsdl-image1.2 and libsdl-image1.2-dev</dt>
<dd>Image loading library for SDL.</dd>

<!-- maybe in the future
<dt>libsdl-net1.2 and libsdl-net1.2-dev</dt>
<dd>Network library for SDL.</dd>
-->

</dl>

<p>
Furthermore, you need the XML library and the PNG library:
</p>

<dl>

<dt>libxml2 and libxml2-dev</dt>
<dd>XML C library, originally developed for GNOME.</dd>

<dt>libpng12-0 and libpng12-0-dev</dt>
<dd>Library for handling PNG images.</dd>

</dl>

<p>
openMSX can optionally use OpenGL for graphics.
If you want to use this, make sure you have both the runtime and development
packages for OpenGL installed.
If you have an nVidia card, go to the
<a class="external" href="http://www.nvidia.com/linux">nVidia web site</a>
for drivers, which include an OpenGL implementation.
For other cards, try Mesa, which can be found in packages like
<code>xlibmesa3</code> and <code>xlibmesa-dev</code> (Debian)
or <code>XFree86-GLX</code> and <code>XFree86-GLX-devel</code> (SuSE).
</p>

<h3><a id="compilenow">3.3. Compilation Itself</a></h3>

<p>
Now that all the necessary tools and libraries are installed,
you are almost ready to start the actual compilation of openMSX.
First, we have to configure the build for your system configuration.
Open a shell and go to the top of your openMSX source tree.
</p>

<p>
If you got the openMSX sources from a CVS checkout or snapshot,
run the following script:
</p>
<div class="commandline">
./autogen.sh
</div>
<p>
This will generate the <code>configure</code> script
and other files required for building.
If you downloaded a release, those files are already present,
so you can skip this step.
</p>

<p>
Now it's time for the <code>configure</code> script to probe
the system configuration.
Just type the following command:
</p>
<div class="commandline">
./configure
</div>
<p>
If you have a Pentium II or higher machine, instead run it like this:
</p>
<div class="commandline">
./config-i686.sh
</div>
<p>
This will let openMSX compile with optimisations for your system's CPU.
</p>

<p>
You will see loads of configuration checks scroll by,
most of it you can just ignore.
However, if <code>configure</code> complains about missing libraries,
you should install them before you can go on.
If this doesn't solve the problem,
<a class="internal" href="#contact">contact the openMSX developers</a>.
If you file a bug report, please attach the <code>config.log</code> file
that is written by the <code>configure</code> script.
</p>

<p>
You can set various compilation parameters using <code>configure</code>.
The following command prints a full list:
</p>
<div class="commandline">
./configure --help
</div>
<p>
For example, you can change the installation directory
(default is <code>/opt/openMSX</code>) by running for example:
</p>
<div class="commandline">
./configure --prefix=/usr/local/openMSX
</div>
<p>
If you are installing openMSX on a system on which you do not have
superuser (root) privileges, you can use the <code>--prefix</code>
option to install into your home directory.
In this case, use the full <code>/home/username/openMSX</code> path,
instead of <code>~/openMSX</code>,
because the Makefiles do not handle tilde expansion properly.
</p>

<p>
After successfully running <code>configure</code>,
it's time to compile everything.
To start compilation, type:
</p>
<div class="commandline">
make
</div>
<p>
Depending on how fast your system is,
this may take several minutes to half an hour.
</p>

<p>
If you get errors during compilation,
there may be something wrong that was not detected by configure.
Verify that you installed
<a class="internal" href="#libs">all required libraries</a>,
both the run time and development packages.
If that doesn't help, or we forgot to list a library openMSX depends on,
<a class="internal" href="#contact">contact the openMSX developers</a>.
Make sure you provide us with the error message you got.
</p>

<h2><a id="install">4. Installation</a></h2>

<p>
To install openMSX, run the following command:
</p>
<div class="commandline">
make install
</div>
<p>
This installs openMSX, by default in <code>/opt/openMSX</code>.
You can override this location by specifying <code>--prefix=location</code>
to <code>configure</code> or <code>config-i686.sh</code>.
Note that only root has rights to write to system-wide directories such as
<code>/opt</code>,
so you may have to do <code>su</code> before <code>make install</code>.
</p>

<p>
The binary of the latest version is about 36MB,
most of which is debugging symbols.
If you don't plan on any debugging and want a smaller executable,
you can "strip" the binary.
Stripping a binary of debugging symbols decreases its size significantly;
the openMSX binary will be reduced to under 2MB.
Instead of running <code>make install</code>, run:
</p>
<div class="commandline">
make install-strip
</div>

<p>
If you want an even smaller binary,
then after <code>make install-strip</code>
you can run <code>gzexe</code> on the binary:
</p>
<div class="commandline">
gzexe /opt/openMSX/bin/openmsx
</div>
<p>
This just compresses the binary, but keeps it still executable.
For this you need the <code>gzip</code> package,
which is installed by default on almost any system.
See also <code>man gzexe</code>.
</p>

<h2><a id="next">5. Next Steps</a></h2>

<p>
If all went well, you should have openMSX installed now.
You can test it by executing openMSX from the command line:
</p>
<div class="commandline">
openmsx
</div>

<p>
You should get a screen similar to this:
</p>
<div class="commandline"><pre>
C-BIOS ver 0.16
Copyright (C) 2002-2003 BouKiCHi

        Cartridge not found.
</pre></div>

<p>
C-BIOS is the default system BIOS used by openMSX.
It was written from scratch by BouKiCHi and he was kind enough to let us
distribute it together with openMSX.
It is not perfect yet, but it runs many ROM games well.
Reikan took over the job of maintaining C-BIOS and has created a
<a class="external" href="http://www.ranpub.com/CBIOS/">web page for C-BIOS</a>.
</p>

<p>
If you have a ROM image ready, you can try to run it with C-BIOS:
</p>
<div class="commandline">
openmsx ~/msx/games/my-favourite-game.rom
</div>

<p>
The next step would be to read the
<a class="external" href="setup.html">openMSX Setup Guide</a>.
That document describes how you can configure openMSX to emulate
actual MSX machines, such as the Panasonic FS-A1GT (turbo R).
It also describes how you can have openMSX start up with your
personal settings, how you can configure openMSX and your system
for optimal performance and several other configuration related
topics.
And finally there is of course the
<a class="external" href="user.html">openMSX User's Manual</a>,
which describes all the things you can do with openMSX once
it is fully running.
</p>

<p>
If you got stuck somewhere in the compilation and installation process,
please contact us. The next chapter will tell you how.
</p>

<h2><a id="contact">6. Contact Info</a></h2>

<p>
Since openMSX is still in heavy development, feedback and bug reports are very
welcome!
</p>

<p>
If you encounter problems, you have several options:
</p>

<ol>
<li>
If you're a regular user and want to discuss openMSX and possible problems,
join our <code>openmsx-user</code> mailing list.
More info on the
<a class="external" href="http://sourceforge.net/mail/?group_id=38274">openMSX mailing lists</a>,
including an archive of old messages, can be found at SourceForge.
</li>
<li>
Go to our IRC channel: <code>#openMSX</code> on <code>irc.freenode.net</code>
and ask your question there.
</li>
<li>
If you want to address the openMSX developers directly,
post a message to the <code>openmsx-devel</code> mailing list.
More info on the
<a class="external" href="http://sourceforge.net/mail/?group_id=38274">openMSX mailing lists</a>,
including an archive of old messages, can be found at SourceForge.
</li>
<li>
Use one of the
<a class="external" href="http://sourceforge.net/tracker/?group_id=38274">openMSX trackers</a>
at SourceForge.
At the moment of writing, there are four trackers:
Bugs, Support Requests, Patches and Feature Requests.
</li>
</ol>

<p>
For experienced users: if you get a crash,
try to provide a <code>gdb</code> backtrace.
This will only work if you did not strip the openMSX binary
of its debug symbols.
</p>

<p>
In any case, try to give as much information as possible when you describe your
bug or request.
</p>

<p class="version">
$Id$
</p>

</body>
</html>
